<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Power Up 3 å•å…ƒè¯æ±‡å¬å†™</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent; /* iPadç‚¹å‡»é«˜äº®å»é™¤ */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 800px;
            width: 100%;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 20px;
            font-size: 2.2em;
        }

        .day-selector {
            text-align: center;
            margin-bottom: 20px;
        }

        select {
            padding: 10px 20px;
            font-size: 1.1em;
            border-radius: 10px;
            border: 2px solid #667eea;
            color: #2d3748;
            outline: none;
            cursor: pointer;
            background: white;
            font-weight: bold;
            max-width: 100%;
            -webkit-appearance: none; /* iPadæ ·å¼ä¼˜åŒ– */
        }

        .settings-row {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            background: #f7fafc;
            padding: 15px;
            border-radius: 12px;
            border: 1px dashed #cbd5e0;
        }

        .setting-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .setting-group label {
            color: #4a5568;
            font-weight: 600;
        }

        .setting-group select {
            padding: 8px 12px;
            font-size: 1rem;
            border: 1px solid #667eea;
            background: white;
        }

        .status {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }

        .status-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 5px 10px;
        }

        .label {
            color: #718096;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .value {
            color: #2d3748;
            font-weight: bold;
            font-size: 1.2em;
        }

        .progress {
            background: #e2e8f0;
            border-radius: 10px;
            height: 30px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .current-word {
            text-align: center;
            font-size: 2.2em;
            font-weight: bold;
            color: #2d3748;
            margin: 40px 0;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.2;
        }

        .starting {
            text-align: center;
            font-size: 1.5em;
            color: #667eea;
            margin: 40px 0;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .controls {
            text-align: center;
            margin-top: 30px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 5px;
            box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08);
            -webkit-appearance: none; /* iPadæŒ‰é’®æ ·å¼ä¿®æ­£ */
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 14px rgba(50, 50, 93, 0.1), 0 3px 6px rgba(0, 0, 0, 0.08);
        }

        button:active {
            transform: translateY(1px); /* è§¦æ‘¸åé¦ˆ */
        }

        button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .answers {
            display: none;
            margin-top: 30px;
        }

        .answers h2 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }

        .answer-list {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch; /* iPadæ»šåŠ¨ä¼˜åŒ– */
        }

        .answer-item {
            padding: 12px;
            margin-bottom: 8px;
            background: white;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .answer-left {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .answer-number {
            color: #667eea;
            font-weight: bold;
            margin-right: 15px;
            min-width: 30px;
        }

        .answer-text {
            color: #2d3748;
            font-size: 1.2em;
            font-weight: 500;
        }

        .answer-meaning {
            color: #718096;
            font-size: 1em;
            text-align: right;
            margin-left: 10px;
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ Power Up 3 å•å…ƒè¯æ±‡å¬å†™</h1>

        <div class="day-selector">
            <select id="daySelect" onchange="loadDay()"></select>
        </div>

        <div class="settings-row">
            <div class="setting-group">
                <label>æ¯è¯æœ—è¯»:</label>
                <select id="repeatCount">
                    <option value="1">1æ¬¡</option>
                    <option value="2">2æ¬¡</option>
                    <option value="3" selected>3æ¬¡</option>
                </select>
            </div>
            <div class="setting-group">
                <label>å†™å­—æ—¶é•¿:</label>
                <select id="waitTime">
                    <option value="5">5ç§’</option>
                    <option value="8">8ç§’</option>
                    <option value="10" selected>10ç§’</option>
                    <option value="12">12ç§’</option>
                    <option value="15">15ç§’</option>
                </select>
            </div>
        </div>

        <div class="status">
            <div class="status-item">
                <span class="label">æœ¬ç»„è¯æ•°</span>
                <span class="value" id="totalCount">0</span>
            </div>
            <div class="status-item">
                <span class="label">å½“å‰è¿›åº¦</span>
                <span class="value" id="currentProgress">0 / 0</span>
            </div>
        </div>

        <div class="progress">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>

        <div class="current-word" id="currentWord" style="display: none;"></div>
        <div class="starting" id="starting">å‡†å¤‡å¼€å§‹...</div>

        <div class="controls">
            <button id="startBtn" onclick="startDictation()">å¼€å§‹å¬å†™</button>
            <button id="pauseBtn" onclick="pauseDictation()" style="display: none;" disabled>æš‚åœ</button>
            <button id="resumeBtn" onclick="resumeDictation()" style="display: none;">ç»§ç»­</button>
            <button id="restartBtn" onclick="resetDictation()" style="display: none; background: #e53e3e;">é‡ç½®</button>
        </div>

        <div class="answers" id="answers">
            <h2>ğŸ“ å¬å†™ç­”æ¡ˆ</h2>
            <div class="answer-list" id="answerList"></div>
        </div>
    </div>

    <script>
        // è¯æ±‡æ•°æ® (åŸºäº PU3 æŒ‡å¼•å•æ•´ç†)
        const wordData = {
            "Unit 1 è¯æ±‡ 1": [
                { "text": "in Russia", "meaning": "åœ¨ä¿„ç½—æ–¯" },
                { "text": "talk about meals", "meaning": "è°ˆè®ºé£Ÿç‰©" },
                { "text": "meal times", "meaning": "ç”¨é¤æ—¶é—´" },
                { "text": "half past twelve", "meaning": "12ç‚¹åŠ" },
                { "text": "seven o'clock", "meaning": "7ç‚¹é’Ÿ" },
                { "text": "midnight", "meaning": "åˆå¤œ" },
                { "text": "half past six", "meaning": "6ç‚¹åŠ" },
                { "text": "half past eight", "meaning": "8ç‚¹åŠ" },
                { "text": "eight o'clock", "meaning": "8ç‚¹é’Ÿ" },
                { "text": "half past nine", "meaning": "9ç‚¹åŠ" },
                { "text": "midday", "meaning": "æ­£åˆ" },
                { "text": "What time is it?", "meaning": "ç°åœ¨å‡ ç‚¹?" },
                { "text": "It's half past twelve.", "meaning": "ç°åœ¨æ˜¯12ç‚¹åŠã€‚" },
                { "text": "breakfast", "meaning": "æ—©é¤" },
                { "text": "a snack", "meaning": "ä¸€é¡¿å°åƒ" },
                { "text": "lunch", "meaning": "åˆé¤" },
                { "text": "dinner", "meaning": "æ™šé¤" },
                { "text": "wake up", "meaning": "èµ·åºŠ" },
                { "text": "go to bed", "meaning": "å»ç¡è§‰" }
            ],
            "Unit 1 è¯æ±‡ 2": [
                { "text": "catch", "meaning": "æŠ“ä½" },
                { "text": "hop", "meaning": "å•è„šè·³" },
                { "text": "skip", "meaning": "è·³ç»³" },
                { "text": "dance", "meaning": "è·³èˆ" },
                { "text": "jump to your places", "meaning": "è·³åˆ°ä½ çš„ä½ç½®" },
                { "text": "practice time", "meaning": "ç»ƒä¹ æ—¶é—´" },
                { "text": "Are you in or out?", "meaning": "ä½ æ˜¯åŠ å…¥è¿˜æ˜¯é€€å‡º?" },
                { "text": "be quiet", "meaning": "ä¿æŒå®‰é™" },
                { "text": "mustn't shout", "meaning": "ç¦æ­¢å¤§å«" },
                { "text": "don't laugh", "meaning": "ä¸è¦ç¬‘" },
                { "text": "with a smile on your face", "meaning": "é¢å¸¦å¾®ç¬‘" },
                { "text": "hold her legs", "meaning": "æŠ“ä½å¥¹çš„è…¿" },
                { "text": "fall into the net", "meaning": "è½å…¥ç½‘ä¸­" },
                { "text": "dress up", "meaning": "æ‰“æ‰®" },
                { "text": "jump", "meaning": "è·³" },
                { "text": "climb", "meaning": "æ”€ç™»" }
            ],
            "Unit 2 è¯æ±‡ 1": [
                { "text": "in China", "meaning": "åœ¨ä¸­å›½" },
                { "text": "in the supermarket", "meaning": "åœ¨è¶…å¸‚é‡Œ" },
                { "text": "shop for food", "meaning": "ä¹°é£Ÿç‰©" },
                { "text": "tea", "meaning": "èŒ¶" },
                { "text": "cup", "meaning": "æ¯" },
                { "text": "coffee", "meaning": "å’–å•¡" },
                { "text": "milkshake", "meaning": "å¥¶æ˜”" },
                { "text": "glass", "meaning": "æ¯" },
                { "text": "cereal", "meaning": "è°·ç‰©é£Ÿç‰©" },
                { "text": "sauce", "meaning": "é…±" },
                { "text": "pancake", "meaning": "è–„ç…é¥¼" },
                { "text": "noodles", "meaning": "é¢æ¡" },
                { "text": "strawberries", "meaning": "è‰è“" },
                { "text": "yogurt", "meaning": "é…¸å¥¶" },
                { "text": "a glass of milkshake", "meaning": "ä¸€æ¯ç‰›å¥¶" },
                { "text": "a cup of coffee", "meaning": "ä¸€æ¯å’–å•¡" },
                { "text": "a bottle of chocolate sauce", "meaning": "ä¸€ç“¶å·§å…‹åŠ›é…±" },
                { "text": "a bowl of cereal", "meaning": "ä¸€ç¢—è°·ç‰©é£Ÿç‰©" }
            ],
            "Unit 2 è¯æ±‡ 2": [
                { "text": "drove (drive) to town", "meaning": "å¼€è½¦å»åŸé•‡" },
                { "text": "the place where May grew (grow) up", "meaning": "May é•¿å¤§çš„åœ°æ–¹" },
                { "text": "the teacher who taught (teach) her", "meaning": "æ•™è¿‡å¥¹çš„è€å¸ˆ" },
                { "text": "got (get) dressed up", "meaning": "ç©¿è¡£æ‰“æ‰®" },
                { "text": "took (take) some photos", "meaning": "æ‹ä¸€äº›ç…§ç‰‡" },
                { "text": "gave (give)", "meaning": "ç»™" },
                { "text": "climbed (climb)", "meaning": "æ”€ç™»" },
                { "text": "wrote (write) this song", "meaning": "å†™è¿™é¦–æ­Œ" }
            ],
            "Unit 3 è¯æ±‡ 1": [
                { "text": "do exercise", "meaning": "åšè®­ç»ƒ" },
                { "text": "on the beach", "meaning": "åœ¨æµ·æ»©ä¸Š" },
                { "text": "bandage", "meaning": "ç»·å¸¦" },
                { "text": "knee", "meaning": "è†ç›–" },
                { "text": "stomach", "meaning": "èƒƒ" },
                { "text": "shoulder", "meaning": "è‚©è†€" },
                { "text": "neck", "meaning": "è„–å­" },
                { "text": "toe", "meaning": "è„šè¶¾" },
                { "text": "finger", "meaning": "æ‰‹æŒ‡" },
                { "text": "elbow", "meaning": "è‚˜éƒ¨" },
                { "text": "back", "meaning": "èƒŒéƒ¨" }
            ],
            "Unit 3 è¯æ±‡ 2": [
                { "text": "is/am/are sick", "meaning": "ç”Ÿç—…äº†" },
                { "text": "is/am/are ill", "meaning": "ä¸èˆ’æœ" },
                { "text": "be quick", "meaning": "å¿«ç‚¹" },
                { "text": "What's the problem?", "meaning": "ä»€ä¹ˆé—®é¢˜?" },
                { "text": "What's the matter?", "meaning": "æ€ä¹ˆäº†?" },
                { "text": "have/has got a cough", "meaning": "å’³å—½" },
                { "text": "have/has got a temperature", "meaning": "å‘çƒ§" },
                { "text": "have/has got sore throat", "meaning": "å–‰å’™ç—›" },
                { "text": "have/has got a cold", "meaning": "æ„Ÿå†’" },
                { "text": "have/has got a backache", "meaning": "èƒŒç—›" },
                { "text": "My stomach hurts.", "meaning": "æˆ‘çš„èƒƒç—›ã€‚" }
            ],
            "Unit 4 è¯æ±‡ 1": [
                { "text": "in India", "meaning": "åœ¨å°åº¦" },
                { "text": "star", "meaning": "æ˜Ÿæ˜Ÿ" },
                { "text": "jungle", "meaning": "ä¸›æ—" },
                { "text": "world", "meaning": "ä¸–ç•Œ" },
                { "text": "waterfall", "meaning": "ç€‘å¸ƒ" },
                { "text": "moon", "meaning": "æœˆäº®" },
                { "text": "sky", "meaning": "å¤©ç©º" },
                { "text": "plant", "meaning": "æ¤ç‰©" },
                { "text": "wave", "meaning": "æµ·æµª" },
                { "text": "island", "meaning": "å²›" }
            ],
            "Unit 4 è¯æ±‡ 2": [
                { "text": "drove (drive) to the beach", "meaning": "å¼€è½¦å»æµ·æ»©" },
                { "text": "sailed (sail) on the sea", "meaning": "åœ¨æµ·ä¸Šèˆªè¡Œ" },
                { "text": "threw (throw) our nets", "meaning": "æ‰”æˆ‘ä»¬çš„ç½‘" },
                { "text": "caught (catch) some fish", "meaning": "æŠ“äº›é±¼" },
                { "text": "bounced (bounce)", "meaning": "å¼¹è·³" },
                { "text": "hopped (hop)", "meaning": "å•è„šè·³è¡Œ" },
                { "text": "skipped (skip)", "meaning": "è·³ç»³" },
                { "text": "kicked (kick)", "meaning": "è¸¢" }
            ],
            "Unit 5 è¯æ±‡ 1": [
                { "text": "in Greece", "meaning": "åœ¨å¸Œè…Š" },
                { "text": "wing", "meaning": "ç¿…è†€" },
                { "text": "striped", "meaning": "æœ‰æ¡çº¹çš„" },
                { "text": "spotted", "meaning": "æœ‰æ–‘ç‚¹çš„" },
                { "text": "silver", "meaning": "é“¶è‰²çš„" },
                { "text": "bright", "meaning": "æ˜äº®çš„" },
                { "text": "gold", "meaning": "é‡‘è‰²çš„" },
                { "text": "light", "meaning": "æ·¡è‰²çš„" },
                { "text": "dark", "meaning": "æš—è‰²çš„" }
            ],
            "Unit 5 è¯æ±‡ 2": [
                { "text": "make all day long", "meaning": "åšä¸€æ•´å¤©" },
                { "text": "plastic", "meaning": "å¡‘æ–™" },
                { "text": "wool", "meaning": "ç¾Šæ¯›" },
                { "text": "wood", "meaning": "æœ¨æ" },
                { "text": "cut them up", "meaning": "æŠŠä»–ä»¬å‰ªç¢" },
                { "text": "cut them out", "meaning": "åˆ‡å‡ºæ¥" },
                { "text": "glue", "meaning": "èƒ¶æ°´" },
                { "text": "These scissors are made of metal.", "meaning": "è¿™å‰ªåˆ€æ˜¯é‡‘å±åšçš„ã€‚" },
                { "text": "This scarf is made of wool.", "meaning": "è¿™æ¡å›´å·¾æ˜¯ç¾Šæ¯›åšçš„ã€‚" },
                { "text": "My box is made of plastic.", "meaning": "æˆ‘çš„ç›’å­æ˜¯å¡‘æ–™åšçš„ã€‚" },
                { "text": "My table's made of wood.", "meaning": "æˆ‘çš„æ¡Œå­æ˜¯æœ¨å¤´åšçš„ã€‚" },
                { "text": "That crown is made of brown card.", "meaning": "ç‹å† æ˜¯ç”¨æ£•è‰²å¡ç‰‡åšçš„ã€‚" },
                { "text": "silver wings", "meaning": "é“¶è‰²çš„ç¿…è†€" }
            ],
            "Unit 6 è¯æ±‡ 1": [
                { "text": "in Turkey", "meaning": "åœ¨åœŸè€³å…¶" },
                { "text": "geography", "meaning": "åœ°ç†" },
                { "text": "history", "meaning": "å†å²" },
                { "text": "sports", "meaning": "è¿åŠ¨" },
                { "text": "maths", "meaning": "æ•°å­¦" },
                { "text": "language", "meaning": "è¯­è¨€" },
                { "text": "music", "meaning": "éŸ³ä¹" },
                { "text": "science", "meaning": "ç§‘å­¦" },
                { "text": "IT", "meaning": "ä¿¡æ¯æŠ€æœ¯" },
                { "text": "art", "meaning": "ç¾æœ¯" }
            ],
            "Unit 6 è¯æ±‡ 2": [
                { "text": "laptop", "meaning": "ç¬”è®°æœ¬ç”µè„‘" },
                { "text": "apps", "meaning": "åº”ç”¨è½¯ä»¶" },
                { "text": "an e-book", "meaning": "ä¸€æœ¬ç”µå­ä¹¦" },
                { "text": "a special rucksack", "meaning": "ä¸€ä¸ªç‰¹æ®Šçš„å¸†å¸ƒèƒŒåŒ…" },
                { "text": "an online dictionary", "meaning": "ä¸€æœ¬åœ¨çº¿è¯å…¸" },
                { "text": "bin", "meaning": "ç®±å­" },
                { "text": "Internet", "meaning": "äº’è”ç½‘" },
                { "text": "find safe websites", "meaning": "æŸ¥æ‰¾å®‰å…¨ç½‘ç«™" },
                { "text": "paste a photo or two", "meaning": "ç²˜è´´ä¸¤å¼ ç…§ç‰‡" },
                { "text": "scissors", "meaning": "å‰ªåˆ€" },
                { "text": "glue", "meaning": "èƒ¶" }
            ],
            "Unit 7 è¯æ±‡ 1": [
                { "text": "in Spain", "meaning": "åœ¨è¥¿ç­ç‰™" },
                { "text": "actor", "meaning": "æ¼”å‘˜" },
                { "text": "waiter", "meaning": "æœåŠ¡å‘˜" },
                { "text": "cook", "meaning": "å¨å¸ˆ" },
                { "text": "driver", "meaning": "é©¾é©¶å‘˜" },
                { "text": "journalist", "meaning": "è®°è€…" },
                { "text": "photographer", "meaning": "æ‘„å½±å¸ˆ" },
                { "text": "artist", "meaning": "è‰ºæœ¯å®¶" },
                { "text": "designer", "meaning": "è®¾è®¡å¸ˆ" },
                { "text": "singer", "meaning": "æ­Œæ‰‹" },
                { "text": "acrobat", "meaning": "æ‚æŠ€æ¼”å‘˜" }
            ],
            "Unit 7 è¯æ±‡ 2": [
                { "text": "What's he like?", "meaning": "ä»–æ˜¯ä»€ä¹ˆæ ·å­çš„?" },
                { "text": "interesting", "meaning": "æœ‰è¶£çš„" },
                { "text": "kind", "meaning": "å‹å–„çš„" },
                { "text": "friendly", "meaning": "å‹å¥½çš„" },
                { "text": "clever", "meaning": "èªæ˜çš„" },
                { "text": "lazy", "meaning": "æ‡’æƒ°çš„" },
                { "text": "lovely", "meaning": "å¯çˆ±çš„" },
                { "text": "unkind", "meaning": "ä¸å‹å–„" },
                { "text": "unfriendly", "meaning": "ä¸å‹å¥½" },
                { "text": "popular", "meaning": "æ¬¢è¿" },
                { "text": "brave", "meaning": "å‹‡æ•¢çš„" }
            ],
            "Unit 8 è¯æ±‡ 1": [
                { "text": "city break", "meaning": "åŸå¸‚ä¼‘æ¯" },
                { "text": "in the USA", "meaning": "åœ¨ç¾å›½" },
                { "text": "They're lost.", "meaning": "ä»–ä»¬è¿·è·¯äº†" },
                { "text": "north", "meaning": "åŒ—" },
                { "text": "east", "meaning": "ä¸œ" },
                { "text": "south", "meaning": "å—" },
                { "text": "west", "meaning": "è¥¿" },
                { "text": "left", "meaning": "å·¦" },
                { "text": "right", "meaning": "å³" },
                { "text": "straight on", "meaning": "ä¸€ç›´å‘å‰" },
                { "text": "on road 95", "meaning": "åœ¨95å·å…¬è·¯ä¸Š" },
                { "text": "get to road 9", "meaning": "åˆ°è¾¾9å·å…¬è·¯" }
            ],
            "Unit 8 è¯æ±‡ 2": [
                { "text": "airport", "meaning": "æœºåœº" },
                { "text": "buildings", "meaning": "å»ºç­‘ç‰©" },
                { "text": "banks", "meaning": "é“¶è¡Œ" },
                { "text": "money", "meaning": "é’±" },
                { "text": "post office", "meaning": "é‚®å±€" },
                { "text": "buy some stamps", "meaning": "ä¹°ä¸€äº›é‚®ç¥¨" },
                { "text": "chemist", "meaning": "åŒ–å­¦å®¶" },
                { "text": "theatre", "meaning": "å‰§é™¢" },
                { "text": "visit a museum", "meaning": "å‚è§‚ä¸€ä¸ªåšç‰©é¦†" },
                { "text": "near the university", "meaning": "é è¿‘å¤§å­¦" },
                { "text": "a brilliant hotel", "meaning": "ä¸€å®¶éå¸¸æ£’çš„é…’åº—" },
                { "text": "restaurant", "meaning": "é¤å…" }
            ],
            "Unit 9 è¯æ±‡ 1": [
                { "text": "What's the hero called?", "meaning": "è‹±é›„å«ä»€ä¹ˆåå­—?" },
                { "text": "in Mexico", "meaning": "åœ¨å¢¨è¥¿å“¥" },
                { "text": "the comic book which he finished", "meaning": "ä»–çœ‹å®Œçš„æ¼«ç”»ä¹¦" },
                { "text": "noisy", "meaning": "åµçš„" },
                { "text": "huge", "meaning": "å·¨å¤§çš„" },
                { "text": "alone", "meaning": "ç‹¬è‡ªä¸€äººçš„" },
                { "text": "strange", "meaning": "å¥‡æ€ª" },
                { "text": "horrible", "meaning": "å¯æ€•" },
                { "text": "little", "meaning": "å°çš„" },
                { "text": "lucky", "meaning": "å¹¸è¿" },
                { "text": "excellent", "meaning": "ä¼˜ç§€" },
                { "text": "special", "meaning": "ç‰¹åˆ«" }
            ],
            "Unit 9 è¯æ±‡ 2": [
                { "text": "This year's tour is over.", "meaning": "ä»Šå¹´çš„å·¡æ¼”ç»“æŸäº†ã€‚" },
                { "text": "pack all your boxes", "meaning": "æ‰“åŒ…ä½ çš„æ‰€æœ‰ç›’å­" },
                { "text": "the enormous tent", "meaning": "å·¨å¤§çš„å¸ç¯·" },
                { "text": "find my pyjamas", "meaning": "æ‰¾åˆ°æˆ‘çš„ç¡è¡£" },
                { "text": "pack my trainers", "meaning": "æ‰“åŒ…æˆ‘çš„è¿åŠ¨é‹" },
                { "text": "pack my suitcase", "meaning": "æ”¶æ‹¾æˆ‘çš„æ‰‹æç®±" },
                { "text": "rucksack", "meaning": "å¸†å¸ƒèƒŒåŒ…" },
                { "text": "make sandcastles by the sea", "meaning": "åœ¨æµ·è¾¹åˆ¶ä½œæ²™å ¡" },
                { "text": "postcard", "meaning": "æ˜ä¿¡ç‰‡" },
                { "text": "views of Mexico", "meaning": "å¢¨è¥¿å“¥é£æ™¯" },
                { "text": "stamp", "meaning": "é‚®ç¥¨" },
                { "text": "the post office", "meaning": "é‚®å±€" }
            ]
        };

        let currentDayWords = [];
        let currentIndex = 0;
        let isPaused = false;
        let isRunning = false;

        window.onload = function() {
            initDaySelector();
            loadDay();
        };

        function initDaySelector() {
            const select = document.getElementById('daySelect');
            const keys = Object.keys(wordData);
            
            keys.forEach(key => {
                const option = document.createElement('option');
                option.value = key;
                option.text = key + ` (${wordData[key].length} words)`;
                select.appendChild(option);
            });
        }

        function loadDay() {
            if (isRunning) {
                alert("è¯·å…ˆåœæ­¢å½“å‰å¬å†™å†åˆ‡æ¢å¤©æ•°ï¼");
                // æ¢å¤ä¹‹å‰çš„é€‰æ‹©
                const previousKey = Object.keys(wordData).find(key => wordData[key] === currentDayWords);
                if (previousKey) document.getElementById('daySelect').value = previousKey;
                return;
            }
            
            const selectedDay = document.getElementById('daySelect').value;
            currentDayWords = wordData[selectedDay];
            
            document.getElementById('totalCount').textContent = currentDayWords.length;
            document.getElementById('currentProgress').textContent = `0 / ${currentDayWords.length}`;
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('progressBar').textContent = '0%';
            
            resetUI();
        }

        function resetUI() {
            document.getElementById('answers').style.display = 'none';
            document.getElementById('starting').style.display = 'flex';
            document.getElementById('starting').textContent = 'å‡†å¤‡å°±ç»ªï¼Œç‚¹å‡»å¼€å§‹';
            document.getElementById('currentWord').style.display = 'none';
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('restartBtn').style.display = 'none';
            document.getElementById('daySelect').disabled = false;
            document.getElementById('repeatCount').disabled = false;
            document.getElementById('waitTime').disabled = false;
        }

        function unlockAudio() {
            // iPad/iOS å¿…é¡»ç”±ç”¨æˆ·äº¤äº’ï¼ˆç‚¹å‡»ï¼‰è§¦å‘ä¸€æ¬¡æ’­æ”¾ï¼Œæ‰èƒ½è§£é”åç»­çš„è‡ªåŠ¨æ’­æ”¾
            const u = new SpeechSynthesisUtterance("");
            window.speechSynthesis.speak(u);
        }

        async function startDictation() {
            if (!('speechSynthesis' in window)) {
                alert("æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³æœ—è¯»åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ Chrome/Edge/Safari ç­‰ç°ä»£æµè§ˆå™¨ã€‚");
                return;
            }

            unlockAudio(); // å…³é”®ï¼šåœ¨ç‚¹å‡»å¼€å§‹æŒ‰é’®æ—¶è§£é”éŸ³é¢‘

            isRunning = true;
            currentIndex = 0;
            document.getElementById('daySelect').disabled = true;
            document.getElementById('repeatCount').disabled = true;
            document.getElementById('waitTime').disabled = true;
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').disabled = false;
            document.getElementById('restartBtn').style.display = 'none';
            document.getElementById('answers').style.display = 'none';

            const startingEl = document.getElementById('starting');
            startingEl.style.display = 'flex';
            
            for (let i = 3; i > 0; i--) {
                startingEl.textContent = `å¬å†™å°†åœ¨ ${i} ç§’åå¼€å§‹...`;
                await sleep(1000);
            }
            startingEl.style.display = 'none';
            document.getElementById('currentWord').style.display = 'flex';

            for (let i = 0; i < currentDayWords.length; i++) {
                currentIndex = i;
                updateProgress();
                await dictateItem(i);
                
                while (isPaused) {
                    await sleep(100);
                }
            }

            finishDictation();
        }

        async function dictateItem(index) {
            const word = currentDayWords[index];
            const displayEl = document.getElementById('currentWord');
            
            const repeatCount = parseInt(document.getElementById('repeatCount').value);
            const waitTime = parseInt(document.getElementById('waitTime').value);

            displayEl.textContent = `å•è¯ ${index + 1}`;
            displayEl.style.color = "#2d3748";

            for (let r = 0; r < repeatCount; r++) {
                if (isPaused) return;
                
                await speak(word.text);
                
                if (r < repeatCount - 1) {
                    await sleep(1500);
                }
            }

            displayEl.style.color = "#718096";
            for (let t = waitTime; t > 0; t--) {
                if (isPaused) return;
                displayEl.textContent = `ç­‰å¾… ${t} ç§’...`;
                await sleep(1000);
            }
        }

        function speak(text) {
            return new Promise((resolve) => {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'en-US'; // å¼ºåˆ¶ç¾å¼å‘éŸ³
                utterance.rate = 0.65; // æ…¢é€Ÿ 0.65
                
                utterance.onend = () => {
                    resolve();
                };
                
                utterance.onerror = (e) => {
                    console.error("Speech error:", e);
                    resolve();
                };

                window.speechSynthesis.speak(utterance);
            });
        }

        function updateProgress() {
            const total = currentDayWords.length;
            const current = currentIndex + 1;
            const percentage = Math.round((current / total) * 100);
            
            document.getElementById('currentProgress').textContent = `${current} / ${total}`;
            const bar = document.getElementById('progressBar');
            bar.style.width = `${percentage}%`;
            bar.textContent = `${percentage}%`;
        }

        function pauseDictation() {
            isPaused = true;
            window.speechSynthesis.cancel();
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('resumeBtn').style.display = 'inline-block';
            document.getElementById('currentWord').textContent = "å·²æš‚åœ";
        }

        function resumeDictation() {
            isPaused = false;
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
        }

        function resetDictation() {
            window.speechSynthesis.cancel();
            isRunning = false;
            isPaused = false;
            resetUI();
            loadDay();
        }

        function finishDictation() {
            isRunning = false;
            document.getElementById('currentWord').textContent = "å¬å†™å®Œæˆï¼";
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('restartBtn').style.display = 'inline-block';
            document.getElementById('daySelect').disabled = false;
            document.getElementById('repeatCount').disabled = false;
            document.getElementById('waitTime').disabled = false;
            
            showAnswers();
        }

        function showAnswers() {
            const list = document.getElementById('answerList');
            list.innerHTML = '';
            
            currentDayWords.forEach((word, index) => {
                const item = document.createElement('div');
                item.className = 'answer-item';
                item.innerHTML = `
                    <div class="answer-left">
                        <span class="answer-number">${index + 1}.</span>
                        <span class="answer-text">${word.text}</span>
                    </div>
                    <span class="answer-meaning">${word.meaning}</span>
                `;
                list.appendChild(item);
            });

            document.getElementById('answers').style.display = 'block';
            document.getElementById('answers').scrollIntoView({ behavior: 'smooth' });
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>